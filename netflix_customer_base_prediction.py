# -*- coding: utf-8 -*-
"""Netflix customer base prediction by Absk024

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/17sMS6kKzAna9A_vt5kqj9EWDPSuJhQmR
"""

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
import math

df = pd.read_csv('/content/Netflix Userbase (1).csv')

df.head()

df.isnull().sum()

df.duplicated().sum()

plt.figure(figsize=(12,6))

df['Country'].value_counts().plot(kind='bar', color='skyblue')

plt.title('Number of Users per Country')

plt.xlabel('Country')

plt.ylabel('Number of Users')

plt.xticks(rotation=45)

plt.show()

columns_titles = {
    'Gender' : 'Gender Counts',
    'Device' : 'Device Counts',
    'Monthly Revenue' : 'Monthly Revenue Counts',
    'Subscription Type' : 'Subscription Type Counts'
}
for column, title in columns_titles.items():
  plt.figure(figsize=(12,6))
  df[column].value_counts().plot(kind='bar', color='skyblue')
  plt.title(title)
  plt.xlabel(column)
  plt.ylabel('Counts')
  plt.xticks(rotation=45)
  plt.show()

user_counts = df['Country'].value_counts().reset_index()
user_counts_by_country = user_counts.rename(columns={'index': 'Country', 'Country': 'User Count'})
user_counts_by_country

user_counts_by_country = df['Country'].value_counts().reset_index()
user_counts_by_country.columns = ['Country', 'User Count']
import plotly.express as px

fig = px.choropleth(user_counts_by_country,
                    locations='Country',
                    locationmode='country names',
                    color='User Count',
                    hover_name='Country',
                    title='User Distribution by Country',
                    color_continuous_scale=px.colors.sequential.Plasma) # Corrected the keyword argument name
fig.update_layout(
    width=1000,
    height=700,
    title_font_size=24,
    geo=dict(showframe=False, showcoastlines=False)
)

plt.figure(figsize=(12,6))

sns.countplot(x='Country', hue='Subscription Type', data=df, palette='Set2')

plt.title('Subscription Type by Country')

plt.xticks (rotation=45)

plt.show()

subs_by_country = df.pivot_table(index='Country', columns ='Subscription Type', values='User ID', aggfunc='count', fill_value=0)

subs_by_country

subs_by_country['Total'] = subs_by_country.sum(axis=1)

subs_by_country

plt.figure(figsize=(12,6))
sns.countplot(x='Country', hue='Gender', data=df, palette='pastel')
plt.title('Gender Distribution by Country')
plt.xticks(rotation=45)
plt.show()

gender_by_country = df.pivot_table(index='Country', columns='Gender', values='User ID', aggfunc='count', fill_value=0)

gender_by_country

subs_by_country_gender = df.pivot_table(index='Country', columns=['Subscription Type', 'Gender'], values='User ID', aggfunc='count', fill_value=0)

subs_by_country_gender

subs_by_country_gender2 = df.pivot_table(index=['Country', 'Gender'], columns='Subscription Type', values='User ID', aggfunc='count', fill_value=0)

subs_by_country_gender2

plt.figure(figsize=(12,6))
df['Age'].value_counts().sort_index().plot(kind='bar', color='skyblue', edgecolor='Black')
plt.title('Age Counts')
plt.xlabel('Age')
plt.ylabel('Count')
plt.show()

df.head()

df['Join Date'] = pd.to_datetime(df['Join Date'], format='%d-%m-%y')
df['Last Payment Date'] = pd.to_datetime(df['Last Payment Date'], format='%d-%m-%y')

df['Duration'] = (df['Last Payment Date'] - df['Join Date']).dt.days

df['Duration Months'] = df['Duration'].apply(lambda x: math.ceil(x/30))

average_duration = df['Duration Months'].mean()

print(f"Average Duration: {average_duration}")

df['LTV'] = df['Monthly Revenue'] * df['Duration Months']

df.head()

ltv_per_country_sum = df.groupby('Country')['LTV'].sum().sort_values(ascending=False)

plt.figure(figsize=(12,6))
ltv_per_country_sum.plot(kind='bar', color='skyblue')
plt.title('LTV per Country')
plt.xlabel('Country')
plt.ylabel('LTV')
plt.xticks(rotation=45)
plt.show

ltv_per_country = df.groupby('Country')['LTV'].mean().sort_values(ascending=False)

plt.figure(figsize=(12,6))
ltv_per_country.plot(kind='bar', color='skyblue')
plt.title('Average LTV per Country')
plt.xlabel('Country')
plt.ylabel('Average LTV')
plt.xticks(rotation=45)
plt.show

revenue_by_device = df.groupby('Device')['LTV'].sum()

plt.figure(figsize=(12,6))
revenue_by_device.plot(kind='bar', color='purple')
plt.title('Revenue by Device')
plt.xlabel('Device')
plt.ylabel('  Total Revenue')
plt.show()

plt.figure(figsize=(12,6))
sns.countplot(x='Device', hue='Gender', data=df)
plt.title('Gender Distribution by Device')
plt.xlabel('Device')
plt.ylabel('Count')
plt.show()



